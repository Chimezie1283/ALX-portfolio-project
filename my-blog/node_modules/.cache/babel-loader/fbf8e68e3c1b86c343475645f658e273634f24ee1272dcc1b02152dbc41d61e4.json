{"ast":null,"code":"import{useState,useEffect}from'react';import{useParams,useNavigate}from\"react-router-dom\";import axios from'axios';import NotFoundPage from\"./Notfoundpage\";import CommentsList from'../components/CommentsList';import AddCommentForm from'../components/AddCommentForm';import useUser from'../hooks/useUser';import articles from'./article-content';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";const ArticlePage=()=>{const[articleInfo,setArticleInfo]=useState({upvotes:0,comments:[],canUpvote:false});const{canUpvote}=articleInfo;const{articleId}=useParams();const navigate=useNavigate();const{user,isLoading}=useUser();useEffect(()=>{const loadArticleInfo=async()=>{const token=user&&(await user.getIdToken());const headers=token?{authtoken:token}:{};const response=await axios.get(\"/api/articles/\".concat(articleId),{headers});const newArticleInfo=response.data;setArticleInfo(newArticleInfo);};if(!isLoading){loadArticleInfo();}},[isLoading,user]);const article=articles.find(article=>article.name===articleId);const addUpvote=async()=>{const token=user&&(await user.getIdToken());const headers=token?{authtoken:token}:{};const response=await axios.put(\"/api/articles/\".concat(articleId,\"/upvote\"),null,{headers});const updatedArticle=response.data;setArticleInfo(updatedArticle);};if(!article){return/*#__PURE__*/_jsx(NotFoundPage,{});}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h1\",{children:article.title}),/*#__PURE__*/_jsxs(\"div\",{className:\"upvotes-section\",children:[user?/*#__PURE__*/_jsx(\"button\",{onClick:addUpvote,children:canUpvote?'Upvote':'Already Upvoted'}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/login');},children:\"Login In to Upvote\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"This article has \",articleInfo.upvotes,\" upvote(s) \"]})]}),article.content.map((paragraph,i)=>/*#__PURE__*/_jsx(\"p\",{children:paragraph},i)),user?/*#__PURE__*/_jsx(AddCommentForm,{articleName:articleId,onArticleUpdated:updatedArticle=>setArticleInfo(updatedArticle)}):/*#__PURE__*/_jsx(\"button\",{onClick:()=>{navigate('/login');},children:\"Login in to add a comment\"}),/*#__PURE__*/_jsx(CommentsList,{comments:articleInfo.comments})]});};export default ArticlePage;","map":{"version":3,"names":["useState","useEffect","useParams","useNavigate","axios","NotFoundPage","CommentsList","AddCommentForm","useUser","articles","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","ArticlePage","articleInfo","setArticleInfo","upvotes","comments","canUpvote","articleId","navigate","user","isLoading","loadArticleInfo","token","getIdToken","headers","authtoken","response","get","concat","newArticleInfo","data","article","find","name","addUpvote","put","updatedArticle","children","title","className","onClick","content","map","paragraph","i","articleName","onArticleUpdated"],"sources":["C:/Users/HP/Documents/alx-portfolio-project/my-blog/src/pages/ArticlePage.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { useParams, useNavigate } from \"react-router-dom\";\r\nimport axios from 'axios';\r\nimport NotFoundPage from \"./Notfoundpage\";\r\nimport CommentsList from '../components/CommentsList';\r\nimport AddCommentForm from '../components/AddCommentForm';\r\nimport useUser from '../hooks/useUser';\r\nimport articles from './article-content';\r\n\r\nconst ArticlePage = () => {\r\n\r\n    const [articleInfo, setArticleInfo] = useState({ upvotes: 0, comments: [], canUpvote: false });\r\n    const { canUpvote } = articleInfo;\r\n    const { articleId } = useParams();\r\n\r\n    const navigate = useNavigate();\r\n\r\n    const { user, isLoading } = useUser();\r\n\r\n    useEffect(() => {\r\n        const loadArticleInfo = async () => {\r\n            const token = user && await user.getIdToken();\r\n            const headers = token ? { authtoken: token } : {};\r\n            const response = await axios.get(`/api/articles/${articleId}`, { headers });\r\n            const newArticleInfo = response.data;\r\n            setArticleInfo(newArticleInfo);\r\n        } \r\n\r\n        if (!isLoading) {\r\n            loadArticleInfo();\r\n        }\r\n        \r\n        \r\n    }, [isLoading, user]);\r\n\r\n    const article = articles.find(article => article.name === articleId);\r\n\r\n    const addUpvote = async () => {\r\n        const token = user && await user.getIdToken();\r\n        const headers = token ? { authtoken: token } : {};\r\n        const response = await axios.put(`/api/articles/${articleId}/upvote`, null, { headers });\r\n        const updatedArticle = response.data; \r\n        setArticleInfo(updatedArticle);\r\n    }\r\n\r\n    if (!article) {\r\n        return <NotFoundPage />\r\n    }\r\n \r\n    return (\r\n        <>\r\n        <h1>{article.title}</h1>\r\n        <div className='upvotes-section'>\r\n            {user\r\n                ? <button onClick={addUpvote}>{canUpvote ? 'Upvote' : 'Already Upvoted'}</button>\r\n                : <button onClick={() => {\r\n                    navigate('/login');\r\n                }}>Login In to Upvote</button>}\r\n        <p>This article has {articleInfo.upvotes} upvote(s) </p>\r\n        </div>\r\n        {article.content.map((paragraph, i) => (\r\n            <p key={i}>{paragraph}</p>\r\n        ))}\r\n        {user\r\n            ? <AddCommentForm\r\n              articleName={articleId}\r\n              onArticleUpdated={updatedArticle => setArticleInfo(updatedArticle)} />\r\n            : <button onClick={() => {\r\n                navigate('/login');\r\n            }}>Login in to add a comment</button>}\r\n        <CommentsList comments={articleInfo.comments} />\r\n        </>\r\n        \r\n    );\r\n} \r\n\r\nexport default ArticlePage;"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,OAASC,SAAS,CAAEC,WAAW,KAAQ,kBAAkB,CACzD,MAAO,CAAAC,KAAK,KAAM,OAAO,CACzB,MAAO,CAAAC,YAAY,KAAM,gBAAgB,CACzC,MAAO,CAAAC,YAAY,KAAM,4BAA4B,CACrD,MAAO,CAAAC,cAAc,KAAM,8BAA8B,CACzD,MAAO,CAAAC,OAAO,KAAM,kBAAkB,CACtC,MAAO,CAAAC,QAAQ,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAEzC,KAAM,CAAAC,WAAW,CAAGA,CAAA,GAAM,CAEtB,KAAM,CAACC,WAAW,CAAEC,cAAc,CAAC,CAAGlB,QAAQ,CAAC,CAAEmB,OAAO,CAAE,CAAC,CAAEC,QAAQ,CAAE,EAAE,CAAEC,SAAS,CAAE,KAAM,CAAC,CAAC,CAC9F,KAAM,CAAEA,SAAU,CAAC,CAAGJ,WAAW,CACjC,KAAM,CAAEK,SAAU,CAAC,CAAGpB,SAAS,CAAC,CAAC,CAEjC,KAAM,CAAAqB,QAAQ,CAAGpB,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAEqB,IAAI,CAAEC,SAAU,CAAC,CAAGjB,OAAO,CAAC,CAAC,CAErCP,SAAS,CAAC,IAAM,CACZ,KAAM,CAAAyB,eAAe,CAAG,KAAAA,CAAA,GAAY,CAChC,KAAM,CAAAC,KAAK,CAAGH,IAAI,GAAI,KAAM,CAAAA,IAAI,CAACI,UAAU,CAAC,CAAC,EAC7C,KAAM,CAAAC,OAAO,CAAGF,KAAK,CAAG,CAAEG,SAAS,CAAEH,KAAM,CAAC,CAAG,CAAC,CAAC,CACjD,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAA3B,KAAK,CAAC4B,GAAG,kBAAAC,MAAA,CAAkBX,SAAS,EAAI,CAAEO,OAAQ,CAAC,CAAC,CAC3E,KAAM,CAAAK,cAAc,CAAGH,QAAQ,CAACI,IAAI,CACpCjB,cAAc,CAACgB,cAAc,CAAC,CAClC,CAAC,CAED,GAAI,CAACT,SAAS,CAAE,CACZC,eAAe,CAAC,CAAC,CACrB,CAGJ,CAAC,CAAE,CAACD,SAAS,CAAED,IAAI,CAAC,CAAC,CAErB,KAAM,CAAAY,OAAO,CAAG3B,QAAQ,CAAC4B,IAAI,CAACD,OAAO,EAAIA,OAAO,CAACE,IAAI,GAAKhB,SAAS,CAAC,CAEpE,KAAM,CAAAiB,SAAS,CAAG,KAAAA,CAAA,GAAY,CAC1B,KAAM,CAAAZ,KAAK,CAAGH,IAAI,GAAI,KAAM,CAAAA,IAAI,CAACI,UAAU,CAAC,CAAC,EAC7C,KAAM,CAAAC,OAAO,CAAGF,KAAK,CAAG,CAAEG,SAAS,CAAEH,KAAM,CAAC,CAAG,CAAC,CAAC,CACjD,KAAM,CAAAI,QAAQ,CAAG,KAAM,CAAA3B,KAAK,CAACoC,GAAG,kBAAAP,MAAA,CAAkBX,SAAS,YAAW,IAAI,CAAE,CAAEO,OAAQ,CAAC,CAAC,CACxF,KAAM,CAAAY,cAAc,CAAGV,QAAQ,CAACI,IAAI,CACpCjB,cAAc,CAACuB,cAAc,CAAC,CAClC,CAAC,CAED,GAAI,CAACL,OAAO,CAAE,CACV,mBAAOzB,IAAA,CAACN,YAAY,GAAE,CAAC,CAC3B,CAEA,mBACIQ,KAAA,CAAAE,SAAA,EAAA2B,QAAA,eACA/B,IAAA,OAAA+B,QAAA,CAAKN,OAAO,CAACO,KAAK,CAAK,CAAC,cACxB9B,KAAA,QAAK+B,SAAS,CAAC,iBAAiB,CAAAF,QAAA,EAC3BlB,IAAI,cACCb,IAAA,WAAQkC,OAAO,CAAEN,SAAU,CAAAG,QAAA,CAAErB,SAAS,CAAG,QAAQ,CAAG,iBAAiB,CAAS,CAAC,cAC/EV,IAAA,WAAQkC,OAAO,CAAEA,CAAA,GAAM,CACrBtB,QAAQ,CAAC,QAAQ,CAAC,CACtB,CAAE,CAAAmB,QAAA,CAAC,oBAAkB,CAAQ,CAAC,cACtC7B,KAAA,MAAA6B,QAAA,EAAG,mBAAiB,CAACzB,WAAW,CAACE,OAAO,CAAC,aAAW,EAAG,CAAC,EACnD,CAAC,CACLiB,OAAO,CAACU,OAAO,CAACC,GAAG,CAAC,CAACC,SAAS,CAAEC,CAAC,gBAC9BtC,IAAA,MAAA+B,QAAA,CAAYM,SAAS,EAAbC,CAAiB,CAC5B,CAAC,CACDzB,IAAI,cACCb,IAAA,CAACJ,cAAc,EACf2C,WAAW,CAAE5B,SAAU,CACvB6B,gBAAgB,CAAEV,cAAc,EAAIvB,cAAc,CAACuB,cAAc,CAAE,CAAE,CAAC,cACtE9B,IAAA,WAAQkC,OAAO,CAAEA,CAAA,GAAM,CACrBtB,QAAQ,CAAC,QAAQ,CAAC,CACtB,CAAE,CAAAmB,QAAA,CAAC,2BAAyB,CAAQ,CAAC,cACzC/B,IAAA,CAACL,YAAY,EAACc,QAAQ,CAAEH,WAAW,CAACG,QAAS,CAAE,CAAC,EAC9C,CAAC,CAGX,CAAC,CAED,cAAe,CAAAJ,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}